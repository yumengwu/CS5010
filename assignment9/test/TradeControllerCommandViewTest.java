import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.UnsupportedEncodingException;

import org.junit.Before;
import org.junit.Test;

import static junit.framework.TestCase.fail;
import static org.junit.Assert.assertEquals;

import java.io.StringReader;

import tradestock.controller.TradeController;
import tradestock.model.stock.Stock;
import tradestock.model.tradeoperation.TradeModel;
import tradestock.model.tradeoperation.TradeOperation;
import tradestock.view.CommandView;
import tradestock.view.IView;

public class TradeControllerCommandViewTest {
  private TradeOperation<Stock> model1;
  private TradeController controller1;
  private IView view1;
  private Readable in;
  private Appendable out;
  private Appendable out1;
  private TradeOperation<Stock> model2;

  @Before
  public void setUp() {
    model1 = new TradeModel();
    out = new StringBuilder();
  }

  @Test
  public void testInvalidConstructor() {
    try {
      IView view = new CommandView(in, out);
      fail();
    }
    catch (IllegalArgumentException e) {
      assertEquals("neither in or out can be null", e.getMessage());
    }
    in = new StringReader("q");

    try {
      IView view1 = new CommandView(in, out1);
      fail();
    }
    catch (IllegalArgumentException e) {
      assertEquals("neither in or out can be null", e.getMessage());
    }
    try {
      controller1 = new TradeController(model1, view1);
      fail();
    }
    catch (IllegalArgumentException e) {
      assertEquals("either model or view is null", e.getMessage());
    }
    view1 = new CommandView(in, out);
    try {
      controller1 = new TradeController(model2, view1);
      fail();
    }
    catch (IllegalArgumentException e) {
      assertEquals("either model or view is null", e.getMessage());
    }
  }

  @Test
  public void testCreateMultiplePortfoliosThenShow() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio first created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio third created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio fourth created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Following are all portfolios: \n"
        + "first\n"
        + "second\n"
        + "third\n"
        + "fourth\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 first 1 second 1 third 1 fourth 2 q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testCreateExistPortfolio() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio first created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Execution Failed. Please try again Reason: Portfolio name already exists.\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 first 1 first q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testShowAllPortfolioBeforeCreateAny() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Following are all portfolios: \n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("2 q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testShowAnExistPortfolioDetail() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio first created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "The detail of first is\n"
        + "\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 first 3 first q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testShowAnNotExistPortfolioDetail() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Execution Failed. Please try again Reason: No such portfolio.\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("3 first q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  //Create multiple portfolios, buy stocks into different portfolios, check cost basis and value
  //in different portfolios.
  @Test
  public void complicateTest() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio first created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 300.0 shares to first on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock MFST 300.0 shares to first on 2019-03-19\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock AMZN 300.0 shares to second on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio third created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOGL 100.0 shares to third on 2019-02-13\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of first at 2019-02-14 is $335420.0\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of first at 2019-03-19 is $335444.5\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of portfolio first by now is $335444.5\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of second at 2019-02-14 is $487355.0\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of second at 2019-03-19 is $487355.0\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of portfolio second by now is $487355.0\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total value of third at 2019-02-01 is $0.0\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total value of third at 2019-03-19 is $119172.0\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Total value of portfolio third by now is $121270.0\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 first 5 first GOOG 300 2019-02-14 1 second "
        + "5 first MFST 300 2019-03-19 5 second amzn 300 2019-02-14 1 third 5 third googl 100 "
        + "2019-02-13 8 2019-02-14 first 8 2019-03-19 first 7 first 8 2019-02-14 second 8 "
        + "2019-03-19 second 7 second 10 2019-02-01 third 10 2019-03-19 third 9 third q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testBuyStocksInDifferentDateThenShowPortfolioDetail() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio first created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 300.0 shares to first on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock MFST 100.0 shares to first on 2019-02-15\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "The detail of first is\n"
        + "GOOG: 300.0\n"
        + "MFST: 100.0\n"
        + "\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 first 5 first GOOG 300 2019-02-14 5 first mfst 100 2019-02-15 3 "
        + "first Q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testBuyStocksToANotExistPortfolio() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Execution Failed. Please try again Reason: No such portfolio.\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("5 second GOOG 50 2019-02-14 q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testBuyStockInvalidStockSymbol() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Execution Failed. Please try again Reason: Text '    \"Error Message\": \""
        + "Invalid API call. Please retry or visit th...' could not be parsed at index 0\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 5 second abab 50 2019-02-14 q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testBuyStockInvalidVolume() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Invalid volume, please try again\n"
        + "\n"
        + "Enter a number represents volume: \n"
        + "Invalid volume, please try again\n"
        + "\n"
        + "Enter a number represents volume: \n"
        + "Invalid volume, please try again\n"
        + "\n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 40.0 shares to second on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 5 second goog -50 -20 -10 40 2019-02-14 q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testBuyStockInvalidDate() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Execution Failed. Please try again Reason: Date cannot be after now\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 5 second goog 40 2039-02-14 q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());

    String except1 = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio s created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Execution Failed. Please try again Reason: Cannot buy in holiday.\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    Readable in1 = new StringReader("1 s 5 second goog 40 2019-02-16 q");
    Appendable out1 = new StringBuilder();
    IView view2 = new CommandView(in1, out1);
    TradeController controller2 = new TradeController(model1, view2);
    controller2.execute();
    assertEquals(except1, out1.toString());

    String except2 = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio first created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Invalid Date Text '02/16/2019' could not be parsed at index 0\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Invalid Date Text '2019/02/16' could not be parsed at index 4\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Invalid Date Text '2019-18-16' could not be parsed: Invalid value for MonthOfYear (valid values 1 - 12): 18\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 40.0 shares to second on 2019-02-06\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    Readable in2 = new StringReader("1 first 5 second goog 40 02/16/2019 2019/02/16 2019-18-16 "
        + "2019-02-06 q");
    Appendable out2 = new StringBuilder();
    IView view3 = new CommandView(in2, out2);
    TradeController controller3 = new TradeController(model1, view3);
    controller3.execute();
    assertEquals(except2, out2.toString());
  }

  @Test
  public void testCostBasisByDateInDifferentDate() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 40.0 shares to second on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock MFST 50.0 shares to second on 2019-02-15\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of second at 2019-02-14 is $44727.0\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of second at 2019-02-15 is $44735.505\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 5 second goog 40 2019-02-14 5 second MFST 50 2019-02-15 "
        + "8 2019-02-14 second 8 2019-02-15 second q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testCostBasisByDateInvalidPortfolioName() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Execution Failed. Please try again Reason: No such portfolio.\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("8 2019-02-15 second q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testCostBasisByDateNotExistPortfolio() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 40.0 shares to second on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock MFST 50.0 shares to second on 2019-02-15\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Execution Failed. Please try again Reason: Date cannot be after now\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 5 second goog 40 2019-02-14 5 second MFST 50 2019-02-15 8 "
        + "2030-03-01 second q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testCostBasisByDateEmptyPortfolio() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 40.0 shares to second on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Execution Failed. Please try again Reason: No such portfolio.\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 5 second goog 40 2019-02-14 8 "
        + "2019-02-14 first q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testCostBasis() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 40.0 shares to second on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock MFST 50.0 shares to second on 2019-02-15\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of portfolio second by now is $44735.505\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 5 second goog 40 2019-02-14 5 second MFST 50 2019-02-15 7 "
        + "second q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testCostBasisByDateDifferentDateSameProfile() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 40.0 shares to second on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of second at 2019-02-15 is $44727.0\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of second at 2019-02-16 is $44727.0\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of second at 2019-02-28 is $44727.0\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 5 second goog 40 2019-02-14 8 2019-02-15 second 8 2019-02-16"
        + " second 8 2019-02-28 second q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testCostBasisNotExistPortfolio() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 40.0 shares to second on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock MFST 50.0 shares to second on 2019-02-15\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Execution Failed. Please try again Reason: No such portfolio.\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 5 second goog 40 2019-02-14 5 second MFST 50 2019-02-15 7 "
        + "first q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testCostBasisEmptyPortfolio() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio first created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 40.0 shares to second on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of portfolio first by now is $0.0\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 1 first 5 second goog 40 2019-02-14 7 "
        + "first q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testTotalValueByDifferentDate() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 40.0 shares to second on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock MFST 50.0 shares to second on 2019-02-15\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total value of second at 2019-02-14 is $44722.0\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total value of second at 2019-02-15 is $45206.704999999994\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 5 second goog 40 2019-02-14 5 second MFST 50 2019-02-15 10 "
        + "2019-02-14 second 10 2019-02-15 second q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testTotalValueByDateOfNotExistPortfolio() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 40.0 shares to second on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock MFST 50.0 shares to second on 2019-02-15\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Execution Failed. Please try again Reason: No such portfolio.\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Execution Failed. Please try again Reason: No such portfolio.\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 5 second goog 40 2019-02-14 5 second MFST 50 2019-02-15 10 "
        + "2019-02-14 first 10 2019-02-15 first q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testTotalValueByDateEmptyPortfolio() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total value of second at 2019-02-14 is $0.0\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total value of second at 2019-02-15 is $0.0\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 10 2019-02-14 second 10 2019-02-15 second q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testTotalValueByDateInvalidDate() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 40.0 shares to second on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock MFST 50.0 shares to second on 2019-02-15\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Execution Failed. Please try again Reason: Date cannot be after now\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 5 second goog 40 2019-02-14 5 second MFST 50 2019-02-15 10"
        + " 2039-02-14 second q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testTotalValueByDateDifferentDateSameProfile() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 40.0 shares to second on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total value of second at 2019-02-15 is $45203.2\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total value of second at 2019-03-14 is $47780.4\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total value of second at 2019-03-18 is $47332.0\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 5 second goog 40 2019-02-14 10 2019-02-15 second 10 "
        + "2019-03-14 second 10 2019-03-18 second q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testTotalValueNotExistPortfolio() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 40.0 shares to second on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock MFST 50.0 shares to second on 2019-02-15\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Execution Failed. Please try again Reason: No such portfolio.\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 5 second goog 40 2019-02-14 5 second MFST 50 2019-02-15 9"
        + " first q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testTotalValueEmptyPortfolio() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Total value of portfolio second by now is $0.0\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 9 second q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testShowAnExistPortfolioDetailByDifferentDate() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio first created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 40.0 shares to second on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock MFST 50.0 shares to second on 2019-02-15\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Detail of portfolio second by 2019-02-14 is: \n"
        + "GOOG: 40.0\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Detail of portfolio second by 2019-02-15 is: \n"
        + "GOOG: 40.0\n"
        + "MFST: 50.0\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 1 first 5 second goog 40 2019-02-14 5 second MFST 50 "
        + "2019-02-15 4 second 2019-02-14 4 second 2019-02-15 q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testShowAnNotExistPortfolioDetailByDate() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Execution Failed. Please try again Reason: No such portfolio.\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 4 first 2019-02-14 q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testShowPortfolioDetailByDateInvalidDate() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Execution Failed. Please try again Reason: Date cannot be after now\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 4 second 2039-03-14 q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testPortfolioDetailByDateEmptyPortfolio() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Detail of portfolio second by 2019-02-14 is: \n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 4 second 2019-02-14 q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testRunOutOfInput() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio first created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n";
    in = new StringReader("1 first");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    try {
      controller1.execute();
    }
    catch (IllegalStateException e) {
      assertEquals("Appendable Fail.\n", e.getMessage());
    }
    assertEquals(except, out.toString());
  }

  @Test
  public void testSetAPI() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio first created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 10.0 shares to first on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of portfolio first by now is $11185.5\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "1 - Use Alpha Vantage API\n"
        + "2 - Use Mock API\n"
        + "\n"
        + "API set\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 10.0 shares to first on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of portfolio first by now is $12190.5\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 first 5 first goog 10 2019-02-14 7 first 11 2 "
        + "5 first goog 10 2019-02-14 7 first q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void testSetCommissionFee() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio first created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 10.0 shares to first on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a commission fee: \n"
        + "Set commission fee as 20.0\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 10.0 shares to second on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of portfolio first by now is $11200.5\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of portfolio second by now is $11200.5\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 first 5 first goog 10 2019-02-14 12 20 1 second 5 second goog "
        + "10 2019-02-14 7 first 7 second q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

  @Test
  public void savePortfolioToFile() {
    String except = "";
    in = new StringReader("1 first 5 first goog 10 2019-02-14 6 first goog 1500 2019-03-01 6 "
        + "first amaz 5000 2019-03-09 1 second 5 second goog 10 2019-02-14 13 first filename q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    String encode = "UTF-8";
    File file = new File("filename");
    Long fileLength = file.length();
    byte[] fileContent = new byte[fileLength.intValue()];
    try {
      FileInputStream in = new FileInputStream(file);
      in.read(fileContent);
      in.close();
    }
    catch (FileNotFoundException e) {
      throw new IllegalArgumentException(e.getMessage());
    }
    catch (IOException e) {
      throw new IllegalArgumentException(e.getMessage());
    }
    try {
      except =  new String(fileContent, encode);
    }
    catch (UnsupportedEncodingException e) {
      throw new IllegalArgumentException(e.getMessage());
    }
    String e = "<portfolio>\n"
        + "\t<portfolio-name>first</portfolio-name>\n"
        + "\t<stock>\n"
        + "\t\t<stock-symbol>GOOG</stock-symbol>\n"
        + "\t\t<transaction-history>\n"
        + "\t\t\t<date>2019-02-14</date>\n"
        + "\t\t\t<sell>false</sell>\n"
        + "\t\t\t<volume>10.0</volume>\n"
        + "\t\t\t<cost>1118.05</cost>\n"
        + "\t\t</transaction-history>\n"
        + "\t\t<transaction-history>\n"
        + "\t\t\t<date>2019-03-01</date>\n"
        + "\t\t\t<sell>false</sell>\n"
        + "\t\t\t<volume>1.3334518623877676</volume>\n"
        + "\t\t\t<cost>1124.9</cost>\n"
        + "\t\t</transaction-history>\n"
        + "\t</stock>\n"
        + "</portfolio>\n";
    assertEquals(e, except);
  }

  //read file create by last test.
  @Test
  public void readPortfolioExistsPortfolio() {
    String expect = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio first created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the file name: (if file is at/going to a specific path, enter the path, "
        + "too or file will save/read at the current path)\n"
        + "Read portfolio from filename\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "The detail of first is\n"
        + "GOOG: 10.0\n"
        + "\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 first 14 filename 3 first q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(expect, out.toString());
  }

  @Test
  public void testReadPortfolioThenBuyCheckCostCheckValueSetAPI() {
    String except = "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Portfolio second created\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Enter the stock symbol: \n"
        + "Enter a number represents volume: \n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Buy Stock GOOG 10.0 shares to second on 2019-02-14\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of portfolio second by now is $11185.5\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Total value of portfolio second by now is $12074.8\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the file name: (if file is at/going to a specific path, enter the path, "
        + "too or file will save/read at the current path)\n"
        + "Read portfolio from filename\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "The detail of first is\n"
        + "GOOG: 11.333451862387768\n"
        + "\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of portfolio first by now is $12690.5\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Total cost basis of first at 2019-02-13 is $0.0\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Total value of portfolio first by now is $13684.916454795983\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Invalid Date Text 'first' could not be parsed at index 0\n"
        + "\n"
        + "Enter a date: yyyy-mm-dd\n"
        + "Enter the name for the portfolio: \n"
        + "Execution Failed. Please try again Reason: No such portfolio.\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Following are all portfolios: \n"
        + "second\n"
        + "first\n"
        + "\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Enter the name for the portfolio: \n"
        + "Total value of portfolio first by now is $13684.916454795983\n"
        + "Please enter the correspond number to execute commands:\n"
        + "1 - Create a new portfolio.\n"
        + "2 - Show all portfolio.\n"
        + "3 - show detail of a portfolio\n"
        + "4 - show detail of a portfolio by a given date\n"
        + "5 - Buy stocks by a given number of shares\n"
        + "6 - Buy stocks by a given amount of money\n"
        + "7 - Check total cost basis of a portfolio\n"
        + "8 - Check total cost basis of a portfolio by a given date\n"
        + "9 - Check total value of a portfolio\n"
        + "10 - Check total value of a portfolio by a given date\n"
        + "11 - Set API\n"
        + "12 - Set commission fee\n"
        + "13 - Save portfolio to file\n"
        + "14 - Read a portfolio from file\n"
        + "q/Q - quit the system.\n"
        + "\n"
        + "Trade quit prematurely.\n"
        + "\n";
    in = new StringReader("1 second 5 second goog 10 2019-02-14 7 second 9 second 14 "
        + "filename 3 first 7 first 8 2019-02-13 first 9 first 10 first 2019-02-14 11 2 9 first q");
    view1 = new CommandView(in, out);
    controller1 = new TradeController(model1, view1);
    controller1.execute();
    assertEquals(except, out.toString());
  }

}
